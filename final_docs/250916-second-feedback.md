1. on-the-fly-nvs 시행해보기
2. 가우시안 스플래팅 사물 말고 방 전체 한번 시행해보기
3. 기존 report 작성한 것들 수정하기
4. PSNR, SSIM, LPIPS에 대하여 추가 학습 후 report 작성하기

---

---
### PSNR (Peak Signal-to-Noise Ratio)
- **PSNR**은 주로 픽셀 단위 오차(MSE: Mean Squared Error)를 기반으로, 재구성된 이미지가 원본과 얼마나 가까운지 **수치적으로 표현**함.
- 신호의 최대 가능 세기 대비 왜곡(노이즈) 세기의 비를 dB로 나타낸 값. -> "신호 전력 대비 잡은 전력"의 비를 사용함. 전력 비율을 로그로 표현한 단위가 dB임.
	- 전력(power) : 진폭의 제곱 평균.

- ![](https://i.imgur.com/ciUJLW4.png)
#### MAX의 의미
- 픽셀 값의 최대치를 의미함. (최대 신호 전력)
- 8비트 영상이면 255, 10비트면 1023, 실수 정규화 데이터면 1.0

#### MSE의 의미
- 원본과 복원 이미지 사이의 픽셀 차이 제곱의 평균임. (잡음 전력)
- 제곱을 하는 이유 : 오차를 바로 평균내면 양수/음수가 상쇄됨. -> MAX도 동일 차원으로 맞추기 위해 제곱을 하는 것.

#### 값 평가
- PSNR 값이 높을수록 두 이미지가 **더 유사**함.
- 20 dB : 손상이 뚜렷함.
- 30 dB : 실용적임
- 40 dB : 매우 양호

---
### SSIM (Structural Similarity Index Measure)
- **SSIM**은 인간의 시각 시스템을 모방하여, 두 이미지 간의 **구조적 유사성**(휘도, 명암비, 구조)을 평가함.

#### 기본식
- $SSIM(x, y) = l(x, y)^α · c(x, y)^β · s(x, y)^γ$
    - 휘도 l(x, y) = (2μxμy + C1) / (μx² + μy² + C1)
	- 대비 c(x, y) = (2σxσy + C2) / (σx² + σy² + C2) 
	- 구조 s(x, y) = (σxy + C3) / (σxσy + C3)
- 각 항에는 지수 가중치를 줄 수 있음. (α=β=γ=1)

#### 휘도 (l(x, y) = (2μxμy + C1) / (μx² + μy² + C1))
- 두 [[패치]]의 평균 밝기 유사도 측정, 평균에 가까울 수록 1에 가까워 짐.
- μx, μy : 각각 패치 x, y의 평균 밝기(휘도)
- C1 : 분모 안정화를 위한 상수

#### 대비 (c(x, y) = (2σxσy + C2) / (σx² + σy² + C2))
- 두 패치의 명암 대비(표준편차) 유사도 측정. 대비 크기가 비슷할 수록 값이 커짐.
- C2 : 안정화 상수

#### 구조 (s(x, y) = (σxy + C3) / (σxσy + C3))
- 평균, 분산을 정규화한 뒤 패턴 상관(공분산)을 비교함. 상관이 높을수록 구조 항이 커짐.
	- "평균과 대비(분산) 차이의 영향"을 없앤 뒤, 남는 패턴의 유사도를 [[공분산 기반 상관]]으로 측정한 값임.
	- 두 패치가 밝거나 대조가 달라도, 패턴이 "함께 오르내리면" s가 커짐. 패턴이 어긋나면 s가 작아짐.
	- 각 패치의 표준편차로 나누면, 명암 대비의 크기 차이의 영향이 줄어듦. -> "얼마나 크게 변하는가" 보다 "어떤 모양으로 변하는가(패턴)"이 강조됨.
- σxy: **두 패치의 공분산**으로, 평균을 뺀 값들이 같은 위치에서 함께 증가·감소하는 정도를 나타냄. 공분산이 클수록 두 패치의 변화 패턴이 동조적임.
- σx, σy: 각 패치의 표준편차(대비 크기)로, “얼마나 세게 변동하는가”를 나타냄. 분모의 σxσy로 나눠줌으로써 대비 차이의 영향(스케일)을 제거함.
- C3 : 보통 C2/2로 둠.

#### 값 평가
- SSIM 값은 0~1 사이이며, ==1에 가까울수록 품질이 높고 **시각적으로 더 유사**==함.
- 블러 처리된 영상 : 평균 밝기는 비슷해 I는 높지만, 표준편차와 공분산이 줄어 c와 s가 낮아짐.


---
### LPIPS (Learned Perceptual Image Patch Similarity)
- 사전학습된 신경망의 여러 계층에서 추출한 특징맵(feature)을 비교해 "사람이 느끼는 지각적 유사성"을 수치화한 지표임.
- 값이 낮을 수록 두 이미지가 지각적으로 비슷하다는 뜻임.

#### 평가 단계
- 1. 동일한 백본 통과: 두 이미지 x와 x0를 같은 사전학습 네트워크에 넣어 여러 층의 특징맵을 얻음.
- 2. 정규화: 각 위치의 채널 벡터를 길이 1로 정규화해, 대비나 전역 스케일 차이보다는 패턴 방향 차이에 초점을 맞춤.
- 3. 채널 가중: 채널별 학습 가중치를 곱해, 사람 지각에 더 중요한 특징 채널에 가중을 더 줌.
- 4. 거리 계산: 위치별로 두 벡터의 L2 거리를 계산함. 가까우면 패턴이 비슷, 멀면 패턴이 다름.
- 5. 공간·계층 평균: 각 층에서 위치별 거리를 평균내고, 층들 사이에서도 평균/합산해 최종 점수를 얻음.

#### 수식 (거리)
![](https://i.imgur.com/FCc9dXB.png)
- 입력 이미지 : $x, x₀$ 두 장의 이미지를 비교함.
- $Σ_l$ : 신경망의 여러 층 l에 대해 합을 냄. 얕은 층은 에지/질감, 깊은 층은 형태/구조를 봄.
- $1/(H_l W_l) Σ_{h,w}$ : 층 $l$의 특징맵 높이 $H_l$, 너비 $W_l$에서 모든 위치$(h,w)$를 평균냄. 즉, 그 층 전체에서 “평균적인 차이”를 계산함.
- $ŷ^l_{hw}(x)$ : 이미지 $x$를 넣었을 때, 층 $l$의 위치$(h,w)$에서 나온 “정규화된(feature 방향만 남긴) 채널 벡터”. 길이를 1로 만든 이유는 크기보다 방향(패턴)에 집중하기 위해서임.
- $ŷ^l_{0hw}(x0)$: 비교 대상 이미지 $x0$에 대해서도 같은 위치$(h,w)$, 같은 층 l에서 얻은 정규화 채널 벡터
- $w_l ⊙ ( ... )$ : 채널별 가중치 $w_l$을 곱해, 사람 지각에 더 중요한 특징 채널의 차이를 더 크게 반영함. $⊙$는 채널별 원소곱.
- $|| · ||^2_2$: 채널 벡터 차이에 대한 $L2$ 제곱거리. 두 벡터가 비슷하면 작고, 다르면 커짐.

#### 값 평가
- 기존 SSIM/PSNR보다, 실제 사람의 “지각”에 더 가까운 품질 평가를 제공함. 특히 GAN, NeRF, 초해상도 등 **딥러닝 기반 이미지 합성 평가**에 많이 사용됨.
- LPIPS 값은 0~1 사이이며, ==0에 가까울수록 품질이 높고 **시각적으로 더 유사**==함.
- 원본 vs 가우시안 블러 : 얕은 층(질감) 특징이 크게 약해져 방향이 달라지면서 저층에서 거리가 커짐. 일부 중간 및 깊은 층에서도 형태 단서가 흐려저 거리가 증가함. -> LPIPS가 커짐.

---
### PSNR, SSIM, LPIPS 중 뭐가 가장 중요할까
#### 언제 무엇을 더 중시하나
- 재현 정확도(의료·문서·측정 데이터): 픽셀 일치가 최우선이므로 PSNR, SSIM 비중을 크게 둔다. 작은 왜곡도 치명적일 수 있어 LPIPS는 보조로 사용한다.
- 지각 품질(복원·초해상도·생성 이미지 시각적 만족): 인간 평가와 상관이 더 높은 LPIPS 비중을 높인다. 많은 연구가 “지각 품질 비교”에 LPIPS를 핵심 지표로 사용한다.
- 균형형(두 마리 토끼): PSNR/SSIM과 LPIPS를 함께 최적화하고, 보고서에서도 세 지표를 병기한다. 최근 논문·리뷰는 세 지표 간 상관이 완전하지 않음을 지적하므로 단일 지표 과신을 피한다.

#### 추천 가중 조합 예시
- 정밀 재현형: w = [PSNR 0.5, SSIM 0.4, LPIPS 0.1]처럼 설정해 수치 일치를 최우선으로.
- 지각 중심형: w = [PSNR 0.2, SSIM 0.3, LPIPS 0.5]처럼 설정해 시각적 품질을 우선.
- 균형형: w = [0.33, 0.33, 0.34]로 시작하고, 데이터/도메인별로 검증 세트에서 사람 평가와의 상관을 봐서 조정.

---