두 패치가 평균·대비(스케일) 차이를 제거한 뒤, 같은 위치에서 함께 오르고 내리는지(동조성)를 공분산을 이용해 측정한다는 뜻이다. 즉 구조 항 s(x,y)는 상관계수와 매우 유사한 형태로, 패턴이 동조할수록 커지고, 어긋날수록 작아진다.

## 핵심 직관

- 평균 제거: 각 패치에서 평균을 빼면 밝기 오프셋 효과가 사라져, “밝은가/어두운가” 대신 “어떻게 변동하나”에 집중한다.
    
- 분산 정규화: 표준편차로 나누면 대비 크기 차이를 상쇄해, “변동의 크기”보다 “변동의 모양(패턴)”이 강조된다.
    
- 공분산: 이렇게 정규화된 두 패치가 같은 위치들에서 함께 증가/감소하면 공분산이 커지고, 반대로 한쪽이 오를 때 다른 쪽이 내리면 작아지거나 음수가 된다.
    

## 구조 항 수식의 의미

- 구조 항: s(x,y) = (σxy + C3) / (σxσy + C3)
    
    - σxy: 두 패치의 공분산으로 “함께 변하는 정도”를 나타낸다.
        
    - σxσy로 나누기: 각자의 변동 크기(스케일)를 제거해 상관(정규화된 공분산)에 가깝게 만든다.
        
    - C3: 0으로 나누기 방지용 안정화 상수로 실전 수치 안정성을 높인다.
        

## 미니 예시로 이해

- 같은 패턴, 밝기만 +10: 평균을 빼면 두 패턴은 거의 동일한 파형 → σxy 큼, σxσy도 큼 → s가 높게 나온다.
    
- 블러된 결과: 에지·세부가 무뎌져 위치별 변동 동조가 약해짐 → σxy 감소 → s가 낮아진다.
    
- 반대 패턴: 원본이 밝아질 때 결과가 어두워지면 위치별 변화가 반대로 움직임 → σxy가 작거나 음수 → s가 낮다.
    

## “상관”과의 관계

- 통계적 상관계수 r = σxy / (σxσy)와 본질적으로 같은 아이디어다.
    
- SSIM의 s(x,y)는 안정화 상수 C3를 포함한 “상관계수의 안정화 버전”이라 보면 된다.
    

요약: 공분산 기반 상관이란, 평균·분산으로 정규화해 밝기·대비 영향은 빼고, 두 패치가 위치별로 함께 오르내리는 “패턴의 동조성”을 공분산으로 측정한다는 뜻이다. 값이 클수록 구조가 더 잘 맞는다고 본다.